(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{36:function(e,t,n){e.exports=n(72)},41:function(e,t,n){},68:function(e,t){},71:function(e,t,n){},72:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(34),i=n.n(o),s=(n(41),n(1)),c=n(2),u=n(5),l=n(3),m=n(7),p=n(4),v=n(35),f=n.n(v),d=n(19),h=n.n(d),y=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).handleClick=function(e){""===n.props.mark&&n.props.move(n.props.identify)},n.handleMouseOver=function(e){var t=n.props,r=t.myTurn;r===t.currentTurn&&n.setState({hoverMark:r})},n.handleMouseOut=function(e){n.setState({hoverMark:""})},n.state={hoverMark:""},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.mark,t=""===e?this.state.hoverMark:"";return a.a.createElement("td",{id:this.props.identify,onClick:this.handleClick,className:"piece-".concat(e).concat(""!==t?" hover":""),onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut},e,t)}}]),t}(a.a.Component),g="https://midoriki.herokuapp.com",b="40",k="40",E=function(e){function t(){var e,n;Object(s.a)(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).componentDidMount=function(){var e=h()("#board"),t=h()("#gomoku");e.scrollLeft((t.width()-e.width())/2),window.scrollTo(0,window.innerHeight/2)},n.move=function(e){var t=n.props;t.myTurn===t.currentTurn&&n.props.updateMove(e)},n.hasMark=function(e){var t=n.props,r=t.xHistory,a=t.oHistory;return r.indexOf(e)>=0?"x":a.indexOf(e)>=0?"o":""},n.drawBoard=function(){for(var e=k,t=b,r=[],o=0;o<e;o++){for(var i=[],s=0;s<t;s++){var c="".concat(o,"-").concat(s);i.push(a.a.createElement(y,{key:c,identify:c,move:n.move,myTurn:n.props.myTurn,currentTurn:n.props.currentTurn,mark:n.hasMark(c)}))}r.push(a.a.createElement("tr",{key:o},i))}return r},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.myTurn,n=e.currentTurn,r=e.score;return a.a.createElement("div",{id:"board",className:"board"},a.a.createElement("div",{className:"control-board"},a.a.createElement("div",{className:"turn"},t===n?"You ":"Opponent ","go"),a.a.createElement("div",{className:"score"},a.a.createElement("div",{className:"point"},r?Object.keys(r).map(function(e,t){return r[e]+(0===t?" - ":"")}):"")),a.a.createElement("div",{className:"action"},a.a.createElement("button",{className:"btn",onClick:this.props.quitGame},"Quit"))),a.a.createElement("table",{id:"gomoku",className:"gomoku"},a.a.createElement("tbody",null,this.drawBoard())))}}]),t}(a.a.Component),O=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.message,n=e.callback,r=e.cancel;return a.a.createElement("div",{className:"popup ".concat(""!==t?"enable":"")},a.a.createElement("div",{className:"content"},a.a.createElement("div",{className:"message"},t),a.a.createElement("div",{className:"action"},"undefined"!==typeof r?a.a.createElement("button",{className:"btn cancel",onClick:r},"No"):"",a.a.createElement("button",{className:"btn",onClick:n},"Ok"))))}}]),t}(a.a.Component),w=function(e){function t(){var e,n;Object(s.a)(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).invite=function(e){e.preventDefault();var t=n.props.user;n.props.invite(t)},n.renderAction=function(){return n.props.canInvite?a.a.createElement("button",{className:"link-button",onClick:n.invite},"invite"):""},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.user;return a.a.createElement("tr",null,a.a.createElement("td",{className:"user"},e.username),a.a.createElement("td",{className:"action"},"waiting"!==e.status?e.status:this.renderAction()))}}]),t}(a.a.Component),j=function(e){function t(){var e,n;Object(s.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(a)))).invite=function(e){n.props.invite(e)},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.users,r=t.myUser;return a.a.createElement("div",{className:"user-list"},a.a.createElement("div",null,"Online users"),a.a.createElement("div",{className:"user-table"},a.a.createElement("table",null,a.a.createElement("tbody",null,n.length<=0?a.a.createElement("tr",null,a.a.createElement("td",{className:"info"},"No one is online")):n.map(function(t,n){return a.a.createElement(w,{canInvite:!(!r||"waiting"!==r.status),key:n,invite:e.invite,user:t})})))))}}]),t}(a.a.Component);var S=function(e){function t(e){var n;Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).updateScore=function(e){var t=n.state,r=t.score,a=t.myUser,o=t.myTurn,i=t.opponent;i||setTimeout(function(){n.updateScore()},1e3);var s=r;r&&"undefined"!==typeof e?r&&(e===o?s[a.username]=s[a.username]+1:s[i.username]=s[i.username]+1):((s={})[a.username]=0,s[i.username]=0),n.setState({score:s})},n.handleQuitGame=function(){n.props.socket.emit("quit"),n.quitGame()},n.resetGame=function(){n.setState({oHistory:[],xHistory:[]})},n.quitGame=function(){n.setState({winner:"",xHistory:[],oHistory:[],myTurn:"",currentTurn:"x",gameStart:!1,invite:null,opponent:null,score:null})},n.gameOver=function(e){var t=e.map(function(e){var t=e.split("-");return[parseInt(t[0]),parseInt(t[1])]}),n=!0,r=!1,a=void 0;try{for(var o,i=function(){var e=o.value,n=e[0],r=t.filter(function(e){return e[0]===n});if(r.length>=5){var a=r.map(function(e){return e[1]}).sort(function(e,t){return+e-+t}),i=!1;if(a.forEach(function(e,t){"undefined"!==typeof a[t+4]&&a[t+4]-e===4&&(i=!0)}),i)return{v:i}}var s=e[1],c=t.filter(function(e){return e[1]===s});if(c.length>=5){var u=c.map(function(e){return e[0]}).sort(function(e,t){return+e-+t}),l=!1;if(u.forEach(function(e,t){"undefined"!==typeof u[t+4]&&u[t+4]-e===4&&(l=!0)}),l)return{v:l}}},s=t[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var c=i();if("object"===typeof c)return c.v}}catch(W){r=!0,a=W}finally{try{n||null==s.return||s.return()}finally{if(r)throw a}}var u=!0,l=!1,m=void 0;try{for(var p,v=function(){for(var e=p.value,n=parseInt(e[0]),r=parseInt(e[1]),a=[],o=function(e){t.filter(function(t){return t[0]===n+e&&t[1]===r+e}).length>0&&a.push(e)},i=1;i<5;i++)o(i);if(a.length>=4)return{v:!0}},f=t[Symbol.iterator]();!(u=(p=f.next()).done);u=!0){var d=v();if("object"===typeof d)return d.v}}catch(W){l=!0,m=W}finally{try{u||null==f.return||f.return()}finally{if(l)throw m}}var h=!0,y=!1,g=void 0;try{for(var b,k=function(){for(var e=b.value,n=parseInt(e[0]),r=parseInt(e[1]),a=[],o=function(e){t.filter(function(t){return t[0]===n-e&&t[1]===r-e}).length>0&&a.push(e)},i=1;i<5;i++)o(i);if(a.length>=4)return{v:!0}},E=t[Symbol.iterator]();!(h=(b=E.next()).done);h=!0){var O=k();if("object"===typeof O)return O.v}}catch(W){y=!0,g=W}finally{try{h||null==E.return||E.return()}finally{if(y)throw g}}var w=!0,j=!1,S=void 0;try{for(var N,x=function(){for(var e=N.value,n=parseInt(e[0]),r=parseInt(e[1]),a=[],o=function(e){t.filter(function(t){return t[0]===n+e&&t[1]===r-e}).length>0&&a.push(e)},i=1;i<5;i++)o(i);if(a.length>=4)return{v:!0}},T=t[Symbol.iterator]();!(w=(N=T.next()).done);w=!0){var I=x();if("object"===typeof I)return I.v}}catch(W){j=!0,S=W}finally{try{w||null==T.return||T.return()}finally{if(j)throw S}}var M=!0,C=!1,H=void 0;try{for(var G,U=function(){for(var e=G.value,n=parseInt(e[0]),r=parseInt(e[1]),a=[],o=function(e){t.filter(function(t){return t[0]===n-e&&t[1]===r+e}).length>0&&a.push(e)},i=1;i<5;i++)o(i);if(a.length>=4)return{v:!0}},q=t[Symbol.iterator]();!(M=(G=q.next()).done);M=!0){var A=U();if("object"===typeof A)return A.v}}catch(W){C=!0,H=W}finally{try{M||null==q.return||q.return()}finally{if(C)throw H}}return!1},n.gameCycle=function(){var e=n.state,t=e.xHistory,r=e.oHistory,a=e.myTurn,o=n.gameOver(t),i=n.gameOver(r),s="";if(o&&(s="x"===a?"You won":"You lose"),i&&(s="o"===a?"You won":"You lose"),o||i){var c=o?"x":"o";n.updateScore(c),s+=". Do you want to play again ?",n.setState({winner:s}),n.resetGame()}},n.toggleGame=function(e){n.setState({winner:"",gameStart:!0,myTurn:e,oHistory:[],xHistory:[],score:null}),n.updateScore()},n.handleChange=function(e){e.preventDefault(),e.target.value.length>20||n.setState({username:e.target.value})},n.handleEnter=function(e){var t=n.props.socket,r=n.state.username;r.length<3||r.length>20?n.setState({message:"Username length must be between 3 and 20"}):(t.emit("register",{username:r}),n.setState({registered:!0}))},n.sendMove=function(e){var t=n.props.socket,r=n.state,a=r.currentTurn;r.myTurn===a&&t.emit("move",{coordinate:e}),n.updateMove(e)},n.updateMove=function(e){var t=n.state,r=t.xHistory,a=t.oHistory;"x"===t.currentTurn?(r.push(e),n.setState({xHistory:r,currentTurn:"o"})):(a.push(e),n.setState({oHistory:a,currentTurn:"x"})),n.gameCycle()},n.displayWinner=function(){var e=n.state.winner;return""!==e?a.a.createElement(O,{message:e,cancel:n.handleQuitGame,callback:function(){n.setState({winner:""})}}):""},n.clearMessage=function(){n.setState({message:""})},n.displayPopup=function(e,t){var r=n.state.message;return""!==r?a.a.createElement(O,{message:r,cancel:t,callback:e}):""},n.handleInvite=function(e){var t=n.props.socket;n.setState({opponent:e}),t.emit("send",{user:e})},n.acceptInvite=function(){var e=n.props.socket,t=n.state.invite;n.toggleGame("o"),e.emit("accept",{type:"invitee",user:t})},n.rejectInvite=function(){var e=n.props.socket,t=n.state.invite;n.setState({invite:null}),e.emit("reject",{user:t})},n.displayInvite=function(){var e=n.state.invite;return e?a.a.createElement(O,{message:"".concat(e.username," want to play with you"),callback:n.acceptInvite,cancel:n.rejectInvite}):""},n.handleKeyUp=function(e){13===e.keyCode&&n.handleEnter()},n.state={gameStart:!1,myUser:null,username:"",myTurn:"x",currentTurn:"x",xHistory:[],oHistory:[],message:"",users:[],registered:!1,opponent:null,invite:null,winner:"",score:null};var r=Object(m.a)(n),o=n.props.socket,i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return window.localStorage.getItem(e)}("user");return i&&o.emit("re_connect",{user:JSON.parse(i)}),o.on("reconnect",function(e){"undefined"!==typeof e.user&&r.setState({registered:!0,username:e.user.username})}),o.on("users",function(e){var t=r.state.username,n=e.users;n&&r.setState({users:n.filter(function(e){return e.username!==t}),myUser:n.find(function(e){return e.username===t})})}),o.on("message",function(e){r.setState({message:e.message}),"duplicated"===e.code&&r.setState({username:"",registered:!1})}),o.on("accept",function(){r.toggleGame("x"),o.emit("accept",{type:"inviter"})}),o.on("reject",function(){r.setState({message:"Opponent don't want to play with you",opponent:null})}),o.on("receive",function(e){r.setState({invite:e.user,opponent:e.user}),o.emit("receive",e)}),o.on("move",function(e){var t=e.coordinate;r.updateMove(t)}),o.on("quit",function(){r.quitGame(),r.setState({winner:"",message:"Opponent left"}),o.emit("opponent_quit")}),o.on("register_success",function(e){!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;window.localStorage.setItem(e,JSON.stringify(t))}("user",e.user)}),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.state,t=e.registered,n=e.gameStart,r=e.username,o=e.myTurn,i=e.currentTurn,s=e.xHistory,c=e.oHistory,u=e.users,l=e.myUser,m=e.score;return n?a.a.createElement("div",null,a.a.createElement(E,{myTurn:o,currentTurn:i,xHistory:s,oHistory:c,updateMove:this.sendMove,quitGame:this.handleQuitGame,score:m}),this.displayWinner()):t?a.a.createElement("div",{className:"lobby"},a.a.createElement("div",{className:"my-user"},"Welcome, ",a.a.createElement("span",{className:"highlight"},l?l.username:""),a.a.createElement("a",{href:"/",id:"home"},a.a.createElement("span",null,"Home"))),a.a.createElement(j,{invite:this.handleInvite,users:u,myUser:l}),this.displayPopup(this.clearMessage),this.displayInvite()):a.a.createElement("div",{className:"register"},a.a.createElement("div",{className:"user-input"},a.a.createElement("input",{className:"input",type:"text",placeholder:"Enter your username",onChange:this.handleChange,onKeyUp:this.handleKeyUp,value:r||""}),a.a.createElement("button",{className:"btn enter",onClick:this.handleEnter},"Go")),this.displayPopup(this.clearMessage))}}]),t}(a.a.Component),N=(n(71),function(e){function t(e){var n;Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).display=function(){var e=n.state,t=e.connected,r=e.socket;return t?a.a.createElement(S,{socket:r}):a.a.createElement("div",{className:"center"},"Connecting... Please wait")},n.state={connected:!1,socket:null};var r=Object(m.a)(n),o=f()(g);return o.on("connect",function(){r.setState({connected:!0,socket:o})}),o.on("disconnect",function(){r.setState({connected:!1,socket:null})}),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{className:"app"},this.display())}}]),t}(a.a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement(N,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[36,1,2]]]);
//# sourceMappingURL=main.abc0d2d8.chunk.js.map